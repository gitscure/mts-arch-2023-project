# ADR.001 Решение о классификации системы
<!-- Название ADR состоит из [ADR.###] [Коротко суть принятого решения] -->

* Статус: Предложено
* Автор: 

## Контекст
<!-- Описание проблемы, требующей решения, причин, побудивших принять решение, ограничений, действовавших на момент принятия решения -->
Для разрабатываемой платформы конференций helloconf.mts.ru необходимо выбрать целевую классификацию, используя ACID|BASE|CAP|PACELC. Правильный выбор классификации по указанным принципам повлияет на выбор соответствующих технологий, что позволить спроектировать наиболее оптимальные с технической, экономической и репиутационной точки зрения архитектурные решения.

## Варианты решения в соответствии с моделью ACID и BASE
<!-- Описание рассмотренных вариантов c их плюсами и минусами -->
### Вариант 1. ACID
* **Плюсы**
  * ACID-системы гарантируют целостность данных и поддерживают правильность их записи и чтения
  * Обеспечивают соответствие транзакций с базой данных, что важно для бизнес-приложений
  * Могут быть использованы в критических приложениях, где недопустимо потерять данные
* **Минусы**
  * ACID-системы могут быть медленными из-за того, что они предоставляют дополнительные гарантии целостности данных
  * Могут быть дорогими в обслуживании и масштабировании, так как обычно требуют полной репликации данных
  * Как правило, не эффективны в системах с большим объемом данных, где скорость доступа к данным важнее, чем гарантии целостности

### Вариант 2. BASE
* **Плюсы**
  * Обычно работают быстрее, чем ACID-системы, так как они не предоставляют таких жестких гарантий целостности данных
  * Могут быть более гибкими в обслуживании и масштабировании, так как не требуют полной репликации данных
  * Более эффективны в системах с большим объемом данных и большим количеством пользователей, где скорость доступа к данным важнее, чем гарантии целостности
* **Минусы**
  * Могут иметь неконсистетные данные при сбоях, что неприемлемо для критических приложений
  * Могут не подходить для бизнес-приложений, где требуется строгое соответствие транзакций с базой данных

## Варианты решения в соответствии с моделью CAP
<!-- Описание рассмотренных вариантов c их плюсами и минусами -->
### Вариант 1. CA
* **Плюсы**
  * Гарантируют согласованность данных и поддерживают правильность их записи и чтения
  * Хорошо подходят для приложений, требующих строгого соблюдения правил целостности данных
  * Гарантируют доступность данных
* **Минусы**
  * Медленны и неэффективными в системах с большим объемом данных и высокой нагрузкой
  * Могут быть дорогими в обслуживании и масштабировании, так как обычно требуют полной репликации данных
  * Не могут работать в условиях сетевых разделений
  * Могут быть менее гибкими, чем системы с более слабой согласованностью

### Вариант 1. CP
* **Плюсы**
  * Обеспечивают баланс между согласованностью и доступностью данных, что позволяет достичь оптимальной производительности
  * Более гибкие, чем CA-системы, потому что они позволяют выбирать между согласованностью и доступностью в зависимости от потребностей приложения
  * Могут быть более экономичными, чем CA-системы, так как они позволяют сократить количество реплицируемых данных
  * Хорошо подходят для приложений, где требуется баланс между целостностью данных и доступностью, например, для приложений, связанных с транзакционными данными
  * Могут обеспечить высокую производительность и масштабируемость, что делает их подходящими для крупномасштабных приложений
* **Минусы**
  * Могут потерять данные в случае сбоев, что может быть неприемлемо для критических приложений
  * Допускают некоторую степень несогласованности данных
  * Могут быть менее гибкими, чем AP-системы, потому что они требуют баланса между согласованностью и доступностью
  * Ограничения целостности данных могут быть несовместимы с некоторыми видами приложений, где основной приоритет - быстрый доступ к данным, а не их сохранность

### Вариант 1. AP
* **Плюсы**
  * Обеспечивают высокую доступность данных и могут работать в условиях сетевых разделений
  * Могут быть более эффективными и масштабируемыми в системах с большим объемом данных и высокой нагрузкой
  * Хорошо подходят для приложений, требующих быстрого доступа к данным
  * Более гибкие, чем системы с более сильной согласованностью
* **Минусы**
  * Могут потерять данные в случае сбоев, что может быть неприемлемо для критических приложений
  * Могут не подходить для приложений, где требуется строгое соблюдение правил целостности данных
  * Возможна более сложная реализация, чем у CA-систем

## Варианты решения в соответствии с моделью PACELC
<!-- Описание рассмотренных вариантов c их плюсами и минусами -->
Так как классификация распределенных систем по CAP в современных реалиях приводит к слишком узкому взгляду на архитектурные решения, то целевое рассмотрение платформы helloconf.mts.ru будет с точки зрения модели PACELC

### Вариант 1. PA/EC
<!-- Описание варианта 1 -->
В разделенном варианте система отдает предпочтение доступности, жертвуя консистентностью. В остальных случаях предпочтение отдается консистентности, не смотря на задержки.
* **Плюсы**
  * Позволяет системе продолжать работать, а пользователям получать данные, даже если происходят сбои в сети или на уровне узлов.
  * Гарантирует, что данные в системе в конечном итоге станут согласованными.
  * Гарантирует, что пользователи могут получить доступ к системе.
* **Минусы**
  * Несогласованность данных может привести к проблемам с целостностью данных и ошибкам при выполнении транзакций в разделенном режиме.
  * Возможно увеличение задержек при записи данных на сервер, так как нужно ждать согласованности данных между разными частями.

### Вариант 2. PA/EL
<!-- Описание варианта 2 -->
В разделенном варианте система отдает предпочтение доступности, жертвуя также как и в варианте 1. В остальных случаях предпочтение отдается высокой скорости ответа.
* **Плюсы**
  * Позволяет системе продолжать работать, даже если происходят сбои в сети или на уровне узлов.
  * Обеспечивает доступ к системе пользователям даже в случае сбоев.
  * Позволяет системе быстро обрабатывать запросы пользователей.
  * Может улучшить общую производительность системы.
* **Минусы**
  * Может привести к проблемам с согласованием данных, если узлы системы работают независимо друг от друга.
  * Может создавать дополнительную нагрузку на узлы системы.

### Вариант 2. PC/EC
<!-- Описание варианта 2 -->
В данном варианте отдается предпочтение консистентности, жертвуя доступностью в разделенном случае и скоростью ответа в прочих случаях. Данный вариант максимально приближен к парадигме ACID.
* **Плюсы**
  * Гарантированная согласованность данных, в т.ч. при возникновении сбоев в сети.
* **Минусы**
  * Возможны проблемы с задержками при записи данных на сервер, так как нужно ждать согласованности данных между разными частями.
  * Увеличенная нагрузка на систему в связи со снижением доступности данных и увеличением времени ответа.

### Вариант 2. PC/EL
<!-- Описание варианта 2 -->
Данная архитектура стремится оставаться консистентной в разделенном варианте. В остальных случаях предпочтение отдается снижению задержек.
* **Плюсы**
  * Гарантирует согласованность данных при разделении.
  * Увеличивает скорость ответа пользователям в обычном режиме.
* **Минусы**
  * При сбоях в сети часть узлов может быть недоступна.
  * При недоступность части узлов, возможна увеличенная нагрузка на остальные узлы.

## Решение
<!-- Описание выбранного решения. Решение должно быть сформулировано чётко ("Мы используем...", "Мы не используем", а не "Желательно.." или "Предлагается..."). 
Должна быть понятна связь между решением и проблемой, почему выбрали именно это решение из вариантов -->
Ключевыми факторами принятия решения о классификации системы стали следующие:
* Проектируемая платформа работает под корпоративным брендом, соответственно, крайне важны репутационные аспекты: необходима максимальная доступность платформы **[QR.002]**, а так высокое быстродействие **[QR.003]**.
* Предполагается большое количество пользователей **[QR.001]**, что опять является требованием в сторону быстродействия **[QR.004]**.
* С другой стороны, в системе не предполагается хранение и обработка крайне чувствительных к консистентности данных, таких как, например, банковские транзакции.
* Система должна быть устойчивой к разделению сети для того, чтобы обеспечить минимальное количество прерываний в проведении конференций **[QR.008]**.

Учитывая ключевые аспекты (быстродействие и доступность), принято решение классифицировать систему как PA/EL в модели PACELC. При этом, система строится, учитывая принципы BASE (Basically Available, Soft state, Eventually consistent). Подход BASE обеспечивает более гибкую и доступную систему, которая может быть использована для больших масштабов данных, где высокая производительность и гибкость более важны, чем транзакционная согласованность.
При использовании CAP-модели, выбирается вариант AP по аналогичный вышеуказанным причинам.

## Последствия
<!-- Положительные и отрицательные последствия (trade-offs). Арх. решения, которые потребуется принять как следствие принятого решения. Если решение содержит риски, то описано, как с ними планируют поступить (за счет чего снижать, почему принять). -->
Классификация системы как PA/EL (BASE) ведет к следующим последствиям:
* **Положительные**
  * Высокая доступность системы, даже при сбоях в сети.
  * Высокая производительность системы: актуально, при большом числе пользователей
  * Гибкость и масштабируемость системы.
* **Отрицательные**
  * Возможны проблемы с целостностью данных и ошибки с транзакциями в период сбоев в работе сети.

