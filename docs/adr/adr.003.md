# ADR.003 Принятие решения о переходе на MongoDB
<!-- Название ADR состоит из [ADR.###] [Коротко суть принятого решения] -->

* Статус: Предложено
* Владелец:

## Контекст
<!-- Описание проблемы, требующей решения, причин, побудивших принять решение, ограничений, действовавших на момент принятия решения -->
В рамках развития helloconf.mts.ru, а также позиционирования продукта на рынке, планируется превращение его в LMS систему. Это означает, как минимум, увеличение количества данных, которые будут храниться в системе, усложнение их структуры ввиду появления дополнительных атрибутов таких, как планы мероприятий, ссылки на материалы, тексты домашнего задания и прочее. Предполагается также, что это приведет к увеличению числа пользователей на платформе.

Необходимо рассмотреть вариант перехода с существующей реляционной БД на MongoDB.

## Варианты решения
<!-- Описание рассмотренных вариантов c их плюсами и минусами -->

### Вариант 1. Остаться на существующей реляционной БД
<!-- Описание варианта 1 -->
* **Плюсы**
  * Структурированность данных: реляционные БД основаны на строгой схеме таблиц, что позволяет хранить данные в четко определенном формате, что упрощает их использование и анализ.
  * Поддержка транзакций: реляционные БД обеспечивают поддержку транзакций, что позволяет управлять целостностью данных и обеспечивать надежность.
  * Затраты: Наименее затратное решение, т.к. нет нужды изменять тех. стек.
  * Простота поддержки: поддержка реляционных БД, в целом, проще. При этом, команда разработки уже хорошо знакома с существующим решением.
* **Минусы**
  * Не масштабируются горизонтально: реляционные БД могут столкнуться с проблемами при обработке большого количества данных в условиях отсутствия горизонтального масштабирования.
  * Сложность в обработке больших объемов данных: реляционные БД могут работать медленно при обработке больших объемов данных, что также может привести к проблемам производительности.

### Вариант 2. Перейти на MongoDB
<!-- Описание варианта 2 -->
* **Плюсы**
  * Гибкость и масштабируемость: MongoDB может обрабатывать большие объемы данных и масштабироваться горизонтально, обеспечивая гибкость в изменении размера кластера базы данных, что может быть актуально при росте нагрузки.
  * Простота в использовании: MongoDB не требует определения схемы данных, что позволяет более быстро выполнять разработку в переходный период, когда итоговая схема данных может быть не определена.
  * Высокая производительность: хранение данных в бинарном формате BSON обеспечивает более высокую производительность при работе с большими объемами данных.
  * Гибкость запросов: можно выполнять запросы на основе структуры документа, а не на основе схемы таблиц, что делает запросы более гибкими.
  * Гибкость данных: добавление новых атрибутов не требует изменения схемы БД.
* **Минусы**
  * Сложность управления транзакциями: MongoDB не обеспечивает поддержку транзакций так же, как это делают реляционные БД, что может вызвать проблемы в управлении целостностью данных.
  * Высокие затраты: Помимо очевидных затрат на переход, MongoDB может потребовать более высоких затрат на ресурсы хранения данных, особенно при больших объемах данных.
  * Сложность разработки и поддержки: Разработка и поддержка решения MongoDB будет сложнее, если команда не имеет достаточного опыта работы с ней.

## Решение
<!-- Описание выбранного решения. Решение должно быть сформулировано чётко ("Мы используем...", "Мы не используем", а не "Желательно.." или "Предлагается..."). 
Должна быть понятна связь между решением и проблемой, почему выбрали именно это решение из вариантов -->
Рассмотрев плюсы и минусы каждого варианта и приняв во внимание ключевые требования по быстродействию работы с большим количеством данных и параллельных потоков запросов, а также необходимость максимально просто выполнять горизонтальное масштабирование, принимается решение о переходе с существующей реляционной БД на MongoDB.

## Последствия
<!-- Положительные и отрицательные последствия (trade-offs). Арх. решения, которые потребуется принять как следствие принятого решения. Если решение содержит риски, то описано, как с ними планируют поступить (за счет чего снижать, почему принять). -->
* **Положительные последствия**
  * Высокая производительность БД, достигаемая, в т.ч. за счет хранения данных в формате BSON, см. [сравнение результатов тестирования](/module_07/mariadb_vs_mongodb.md).
  * MongoDB прекрасно масштабируется горизонтально, что актуально при увеличении нагрузки на БД ввиду большого количества новых данных, а также протенциальных пользователей.
  * Высокая гибкость запросов и данных позволит максимально бесшовно добавлять новые фичи, не заботясь о схеме данных БД.
* **Отрицательные последствия**
  * В условиях отсутствия поддержки управления транзакциями, возможны некритичные нарушения целостности данных.
  * Необходимы затраты на переход, включая обучение команды различным аспектам работы с MongoDB.